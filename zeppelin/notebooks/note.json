{
  "paragraphs": [
    {
      "text": "import org.apache.spark.streaming._\nimport org.apache.spark.streaming.kafka._\nimport org.apache.spark.SparkConf\nimport java.util.Date\n\nimport com.lambdaworks.jacks.JacksMapper\n\nval ssc \u003d new StreamingContext(sc, Seconds(2))\n\nval messages \u003d KafkaUtils.createStream(ssc, \"52.0.124.231:2181\", \"my-consumer-group\", Map(\"device_notification\" -\u003e 1))\nval msgs \u003d messages.window(Seconds(30))\n\ncase class ParsedNotification(deviceGuid: String, notification: String, timestamp: String, parameters: String)\ncase class Notification(deviceGuid: String, timestamp: String, mac: String, uuid:String, value: Double)\n\nmsgs.map(\n    msg \u003d\u003e JacksMapper.readValue[Map[String, Any]](msg._2)\n).map(\n  notificationMap \u003d\u003e ParsedNotification(\n    notificationMap.get(\"deviceGuid\").get.asInstanceOf[String],\n    notificationMap.get(\"notification\").get.asInstanceOf[String],\n    notificationMap.get(\"timestamp\").get.asInstanceOf[String],\n    notificationMap.get(\"parameters\").get.asInstanceOf[Map[String, String]].getOrElse(\"jsonString\", \"{}\"))\n).filter(\n    parsed \u003d\u003e parsed.notification \u003d\u003d \"NotificationReceived\"\n).map(\n    nmap \u003d\u003e (nmap.deviceGuid, nmap.timestamp, JacksMapper.readValue[Map[String, Any]](nmap.parameters))\n).filter(\n    nmap \u003d\u003e nmap._3.get(\"uuid\").get.asInstanceOf[String] \u003d\u003d \"f000aa1104514000b000000000000000\"    \n).map(\n    x \u003d\u003e Notification(x._1, x._2.substring(11,19), \n    x._3.get(\"mac\").get.asInstanceOf[String],\n    x._3.get(\"uuid\").get.asInstanceOf[String],\n    x._3.get(\"value\").get.asInstanceOf[Double])\n).foreachRDD( rdd\u003d\u003e\n    rdd.toDF().registerTempTable(\"notifications\")\n)\n\nssc.start()\n\n",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1436539696506_1006264736",
      "id": "20150710-174816_1694727523",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "import org.apache.spark.streaming._\nimport org.apache.spark.streaming.kafka._\nimport org.apache.spark.SparkConf\nimport java.util.Date\nimport com.lambdaworks.jacks.JacksMapper\nssc: org.apache.spark.streaming.StreamingContext \u003d org.apache.spark.streaming.StreamingContext@38e9c8ce\nmessages: org.apache.spark.streaming.dstream.ReceiverInputDStream[(String, String)] \u003d org.apache.spark.streaming.kafka.KafkaInputDStream@64fe7655\nmsgs: org.apache.spark.streaming.dstream.DStream[(String, String)] \u003d org.apache.spark.streaming.dstream.WindowedDStream@266125f0\ndefined class ParsedNotification\ndefined class Notification\n"
      },
      "dateCreated": "Jul 10, 2015 5:48:16 PM",
      "dateStarted": "Jul 20, 2015 6:54:52 PM",
      "dateFinished": "Jul 20, 2015 6:55:15 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sql select * from notifications",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "timestamp",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "value",
              "index": 4.0,
              "aggr": "sum"
            }
          ],
          "groups": [
            {
              "name": "deviceGuid",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "scatter": {
            "xAxis": {
              "name": "deviceGuid",
              "index": 0.0,
              "aggr": "sum"
            }
          }
        },
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1436539757732_-1154577032",
      "id": "20150710-174917_34114203",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "deviceGuid\ttimestamp\tmac\tuuid\tvalue\n"
      },
      "dateCreated": "Jul 10, 2015 5:49:17 PM",
      "dateStarted": "Jul 20, 2015 6:57:19 PM",
      "dateFinished": "Jul 20, 2015 6:57:19 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sql select value, timestamp from notifications where value \u003e ${threshold\u003d0.2} ",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "stackedAreaChart",
          "height": 300.0,
          "optionOpen": true,
          "keys": [
            {
              "name": "timestamp",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "value",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "value",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "timestamp",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        }
      },
      "settings": {
        "params": {
          "maxAge": "0.2",
          "threshold": "0.2"
        },
        "forms": {
          "threshold": {
            "name": "threshold",
            "defaultValue": "0.2",
            "hidden": false
          }
        }
      },
      "jobName": "paragraph_1437322440974_57339951",
      "id": "20150719-191400_2133889819",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "value\ttimestamp\n0.9381543480646797\t11:58:47\n0.44537159909773616\t11:58:49\n0.7546361198001541\t11:58:51\n0.23590172633901238\t11:58:55\n"
      },
      "dateCreated": "Jul 19, 2015 7:14:00 PM",
      "dateStarted": "Jul 20, 2015 2:59:15 PM",
      "dateFinished": "Jul 20, 2015 2:59:16 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1437324230976_-307628056",
      "id": "20150719-194350_1884810433",
      "dateCreated": "Jul 19, 2015 7:43:50 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Kafka",
  "id": "2ATN1D2NH",
  "angularObjects": {},
  "config": {
    "looknfeel": "default"
  },
  "info": {}
}